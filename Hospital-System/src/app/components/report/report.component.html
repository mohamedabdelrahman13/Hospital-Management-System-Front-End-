<section>
    <div class="my-2">
        <label for="viewSelect">View by :</label>
        <select id="viewSelect" class="form-select" [(ngModel)]="selectedView" (change)="updateStats(selectedView)">
          <option value="daily">Daily</option>
          <option value="monthly">Monthly</option>
        </select>
    </div> 
</section>

<!-- report Section -->

<div class="report-wrapper" #report>
    <!-- Header -->
    <header class="report-header">
      <div class="logo-title">
        <h1>Hospital Management System</h1>
        <p class="subtitle">Official Report</p>
      </div>
      <div class="report-info">
        <p><strong>Date:</strong> {{ today | date:'fullDate' }}</p>
        <p><strong>Generated By:</strong> Admin</p>
      </div>

    </header>
    <div class="text-center report-title">
       <h2>{{selectedView | titlecase}} Hospital Management Statistics Report</h2>
    </div>
  
    <!-- Section: Patient Registration Trends -->
    <section class="report-section">
      <h2>Patient Registration Trends</h2>
      <table class="report-table">
        <thead>
          <tr>
            <th *ngIf="this.selectedView === 'monthly'">Month</th>
            <th *ngIf="this.selectedView === 'daily'">Day</th>
            <th>Total Patients</th>
            <th>Percentage</th>
          </tr>
        </thead>
        <tbody>
          @for(item of patientsTrendStats; track $index){
            <tr>
            <td *ngIf="this.selectedView === 'daily'">{{item.time | date:'mediumDate'}}</td>
            <td *ngIf="this.selectedView === 'monthly'">{{item.time | date:'MMMM yyyy'}}</td>
            <td>{{item.numberOfPatients}}</td>
            <td>{{item.percentage}} %</td>
          </tr>
          }
        </tbody>
      </table>
      <p class="summary fw-bold" *ngIf="selectedView === 'monthly'">
        Registrations have shown consistent growth with the highest increase in <span style="color: var(--primary-color);">{{this.heighestPatientRegisterationMonth |  date:'MMMM' }}</span>.
      </p>
      <p class="summary fw-bold" *ngIf="selectedView === 'daily'">
        Registrations have shown consistent growth with the highest increase in <span style="color: var(--primary-color);">{{this.heighestPatientRegisterationDay |  date:'mediumDate' }}</span>.
      </p>
    </section>
    <!-- Section: Patient Registration Trends -->
    



    <!-- Section: Appointment Distribution -->
    <section class="report-section">
      <h2>Appointments Distribution</h2>
      <table class="report-table">
        <thead>
          <tr>
            <th *ngIf="this.selectedView === 'daily'">Day</th>
            <th *ngIf="this.selectedView === 'monthly'">Month</th>
            <th>Appointments</th>
            <th>Percentage</th>
          </tr>
        </thead>
        <tbody>
          @for(item of appStats; track $index){
            <tr>
              <td *ngIf="this.selectedView === 'daily'">{{item.time | date:'mediumDate'}}</td>
              <td *ngIf="this.selectedView === 'monthly'">{{item.time | date:'MMMM yyyy'}}</td>
                <td>{{item.numberOfAppointments}}</td>
                <td>{{item.percentage}} %</td>
            </tr>
          }
        </tbody>
      </table>
      <p class="summary fw-bold" *ngIf="selectedView === 'monthly'">
        Appointments reached their peak during <span style="color: var(--primary-color);">{{this.heighestAppStatsMonth |  date:'MMMM' }}</span>.
      </p>
      <p class="summary fw-bold" *ngIf="selectedView === 'daily'">
        Appointments reached their peak during <span style="color: var(--primary-color);">{{this.heighestAppStatsDay |  date:'mediumDate' }}</span>.
      </p>
    </section>
    <!-- Section: Appointment Distribution -->
    
    
    
    
    
    <!-- Section: Revenue Distribution -->
    <section class="report-section">
      <h2>Revenue Distribution</h2>
      <table class="report-table">
        <thead>
          <tr>
            <th *ngIf="this.selectedView === 'daily'">Day</th>
            <th *ngIf="this.selectedView === 'monthly'">Month</th>
            <th>Revenue</th>
          </tr>
        </thead>
        <tbody>
          @for(item of revenueStats; track $index){
            <tr>
              <td *ngIf="this.selectedView === 'daily'">{{item.time | date:'mediumDate'}}</td>
              <td *ngIf="this.selectedView === 'monthly'">{{item.time | date:'MMMM yyyy'}}</td>
              <td>{{item.revenue}}</td>
            </tr>
          }
        </tbody>
      </table>
      <p class="summary fw-bold" *ngIf="selectedView === 'monthly'">
        Revenue reached its highest level in <span style="color: var(--primary-color);">{{this.heighestRevenueMonth |  date:'MMMM' }}</span>.
      </p>
      <p class="summary fw-bold" *ngIf="selectedView === 'daily'">
        Revenue reached its highest level in <span style="color: var(--primary-color);">{{this.heighestRevenueDay |  date:'mediumDate' }}</span>.
      </p>
    </section>
    <!-- Section: Revenue Distribution -->
    


    <!-- Footer -->
    <footer class="report-footer">
      <p>Â© 2025 Hospital Management System | Confidential Report</p>
    </footer>
  </div>


  <div class="text-center">
    <button class="btn" (click)="exportPDF()">Export as PDF</button>
  </div>